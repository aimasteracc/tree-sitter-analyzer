# タスク計画: tree_sitter_analyzerコードの品質改善

## タスク名
tree_sitter_analyzerコードの品質改善

## 目標
Code Skepticモードで問題を発見し、Code Simplifierモードで修正することで、コードベースの品質を向上させる。

## フェーズ

### Phase 1: Code Skepticによる問題発見
**ステータス**: ✅ complete

**目的**:
- コードベース全体をCode Skepticモードで分析
- 品質問題、アンチパターン、改善機会を特定
- 発見事項を優先度別に分類

**成果物**:
- ✅ findings.mdに記録された問題リスト（19件の主要問題を特定）
- ✅ 優先度付けされた修正推奨事項（高: 5件、中: 5件、低: 3件）

**完了日**: 2026-01-15

### Phase 2: Code Simplifierによる修正
**ステータス**: 🔄 in_progress

**目的**:
- Phase 1で発見された問題をCode Simplifierモードで修正
- コードの簡潔性と保守性を向上
- リファクタリングの実施

**成果物**:
- ✅ 修正されたコードファイル（api.py, query_service.py, 5つの言語プラグイン）
- ✅ 変更内容の記録（progress.mdに詳細記録）

**進捗状況**:
- ✅ api.pyの重複コード削除と複雑度削減（120行削減）
- ✅ 例外処理の改善（74箇所を具体的な例外型に変更）
- ✅ query_service.pyの深いネスト削減（5段階→3段階）
- ✅ グローバルシングルトンパターンの削除
- ✅ API関数の責務分離（3つのヘルパー関数を作成）
- ✅ 木構造走査アルゴリズムの最適化（再帰→反復）
- 🔄 言語プラグインのコード重複削除（進行中）
- ⏳ mcp/server.pyの分割（未着手）
- ⏳ cli_main.pyの分割（未着手）

### Phase 3: 結果の検証とレポート作成
**ステータス**: ⏳ pending

**目的**:
- 修正後のコード品質を検証
- テストの実行と確認
- 最終レポートの作成

**成果物**:
- 検証結果レポート
- 改善前後の比較
- 今後の推奨事項

## タイムライン
- 開始日: 2026-01-15
- 予定完了日: TBD

## 関連ドキュメント
- findings.md - Code Skepticの発見事項
- progress.md - セッションログと進捗記録
