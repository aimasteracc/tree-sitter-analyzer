# Develop Branch Automation
# Automated validation and PR creation for develop branch

name: Develop Branch Automation

on:
  push:
    branches:
      - develop
  workflow_dispatch:

concurrency:
  group: develop-${{ github.ref }}
  cancel-in-progress: true

permissions:
  contents: write
  pull-requests: write

jobs:
  # Note: Test suite is automatically run by ci.yml.
  # This workflow handles the transition to main branch.

  build:
    name: Build Verification
    uses: ./.github/workflows/reusable-build.yml

  create-release-pr:
    name: Create Release PR
    needs: [build]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/develop'
    steps:
      - uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Create Pull Request to main
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          base: main
          branch: develop-to-main
          title: "ðŸš€ Develop to Main: Automated Release"
          body: |
            ## ðŸ¤– Automated Release from Develop Branch
            This PR was automatically generated after successful quality verification.

            ### âœ… Quality Checkpoint
            - **Build Status**: Passed
            - **CI Pipeline**: Expected success (see CI workflow)
            - **Security Scan**: Completed

            ### ðŸš€ Ready for Production
            This release is ready for merge to main branch.

            ---
            *Authoritative CI/CD Pipeline*
          delete-branch: true
          commit-message: "chore: Automated release from develop branch"
