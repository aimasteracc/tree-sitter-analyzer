# Reusable Quality Workflow
# Standardized Linting, Type Checking, and Security Scanning

name: Reusable Quality Workflow

on:
  workflow_call:

jobs:
  quality:
    name: Code Quality Checks
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Analyzer
        uses: ./.github/actions/setup-analyzer
        with:
          os: ubuntu-latest
          python-version: "3.11"
          uv-sync: "true"

      - name: Run Ruff
        run: |
          uv run ruff check .
          echo "✅ Ruff linting passed" >> $GITHUB_STEP_SUMMARY

      - name: Run MyPy
        run: |
          uv run mypy tree_sitter_analyzer/
          echo "✅ MyPy type checking passed" >> $GITHUB_STEP_SUMMARY

      - name: Run Bandit
        run: |
          uv run --with bandit bandit -r tree_sitter_analyzer/ -f json -o bandit-results.json
          echo "✅ Bandit security scan passed" >> $GITHUB_STEP_SUMMARY
